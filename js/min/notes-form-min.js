!function($){var o={notesFormWrapper:$(".nd-notes-wrapper"),notesForm:$(".nd-notes-form"),notesFormText:$(".nd-notes-content"),notesFormEmail:$(".nd-notes-email"),notesFormButton:$(".nd-notes-button"),notesCloseButton:$(".nd-notes-close"),notesSendButton:$(".nd-notes-send"),addNotesButton:$(".add-notes-button"),formActive:!1,init:function(){o.notesFormButton.on("click",function(){o.toggleForm()}),o.notesCloseButton.on("click",function(){o.toggleForm()}),o.notesForm.on("submit",function(e){e.preventDefault(),o.submitNotesForm($(this))}),o.addNotesButton.on("click",function(){var e=$(this);o.addNotes(e)})},addNotes:function(e){var t="\n \n"+e.siblings(".nd-text-content").text().trim()+"\n ----------------------------------------------------------- \n";o.notesFormText.val(o.notesFormText.val()+t),o.notesFormText.scrollTop(o.notesFormText[0].scrollHeight),e.html("NOTES COPIED"),setTimeout(function(){e.html('<span class="glyphicon glyphicon-plus" aria-hidden="true"></span> COPY TO NOTES')},3e3)},toggleForm:function(){if(o.removeErrors(),o.formActive)o.notesFormWrapper.fadeOut(),$("body, html").removeClass("no-scroll");else{var e=o.notesFormText;o.notesFormWrapper.fadeIn(),$("body, html").addClass("no-scroll"),o.notesFormText.scrollTop(o.notesFormText[0].scrollHeight)}o.formActive=!o.formActive},preventTouchScrolling:function(o){"nd-notes-content"!==o.target.attr("class")&&o.preventDefault()},removeErrors:function(){o.notesFormEmail.removeClass("error"),o.notesFormText.removeClass("error")},submitNotesForm:function(){o.removeErrors();var e=o.notesFormEmail.val(),t=o.notesFormText.val(),n=!1;""===e&&(o.notesFormEmail.addClass("error"),n=!0),""===t&&(o.notesFormText.addClass("error"),n=!0),n||(o.notesSendButton.prop("disabled",!0),o.notesSendButton.val("SENDING..."),$.ajax({method:"POST",url:"/wp-content/plugins/notedeck/ajax/email_handler.php",data:{email:e,content:t}}).done(function(e){o.handleSubmitedForm(e)}))},handleSubmitedForm:function(e){if(e)o.notesFormEmail.val(""),o.notesFormText.val(""),o.toggleForm();else{o.notesForm.before('<div class="email-failed alert alert-danger" role="alert"><strong>WARNING!</strong> An error occured while trying to send the email!</div>');var t=o.notesFormWrapper.find(".email-failed").hide().slideDown();setTimeout(function(){t.slideUp("fast",function(){t.remove()})},3e3)}o.notesSendButton.prop("disabled",!1),o.notesSendButton.val("SEND")}};o.init()}(jQuery);